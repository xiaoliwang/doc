# M站 PHP 开发手册

[TOC]

| 版本    | 创建/更新者 | 创建/更新时间   |
| ----- | ------ | --------- |
| 0.1.0 | 杰朋     | 2017/9/19 |



## 编程规范

### 命名规范

#### 概要

1. 【**强制**】代码中的命名均不能以 *下划线* 开始，也不能以  *下划线或美元符号* 结束。

2. 【**强制**】代码命名必须使用正确的英文拼写，让阅读者容易理解，避免歧义。

3. 【**强制**】使用规范的缩写。

   例如：dev = device; admin = administrator; def = define, func = function等。

4. 【**强制**】命名空间统一使用小写，单数。

5. 【**强制**】禁止使用关键字对变量，方法及类进行命名。



#### 类命名规范

1. 【**强制**】类名使用 **PascalCase** 风格，但以下情形例外：XML，TCP 等

2. 【**强制**】抽象类命名使用 *Base* 开头。

3. 【**强制**】异常类命名使用 *Exception* 结尾。

4. 【**强制**】测试类命名以它要测试的类的名称开始，以 *Test* 结尾。

5. 【**推荐**】如果使用设计模式，建议在类名中体现具体模式。

   例如：OrderFactory， LoginProxy 等



#### 方法命名规范

1. 【**强制**】方法名统一使用**camelCase**风格。
2. 【参考】model 层方法命名规约：
   1. 获取单个对象的方法使用 get 做前缀
   2. 获取多个对象的方法使用 list 做前缀
   3. 获取统计值的方法用 count 做前缀
   4. 插入的方法用 save 做前缀



#### 变量命名规则

1. 【**强制**】参数名、成员变量、局部变量统一使用**under_score**风格
2. 【**强制**】常量命名全部大写，单词间使用下划线隔开。名字可以很长。
3. 【**强制**】布尔类型的变量。统一使用 *is_xxx*。
4. 【**强制**】全局常量必须定义在常量配置文件内。








## 异常日志



## MySQL 数据库



## 工程结构



## 安全约束

1. 【**强制**】隶属于用户个人的页面或者功能，必须进行权限控制检验

2. 【**强制**】用户敏感数据禁止直接展示，必须对展示数据进行脱敏

   【说明】：查看用户手机隐藏中间四位。185\*\*\*\*3344。防止泄露。

3. 【**强制**】用户请求传入的任何参数必须做有效性验证

   1. page size：一般为 1 到 50 的正整数
   2. order by：一般传值为数字，后端进行具体验证处理
   3. 任意重定向
   4. SQL 注入
   5. 反序列化注入

4. 【强制】禁止向 HTML 页面输出未经安全过滤或为正确转义的用户数据。

5. 【强制】浏览器进行表单、AJAX 提交必须执行 CSRF 安全过滤

6. 【**强制**】短信上线控制（具体由产品经理控制）

   1. 阿里（同一个签名）
      1. 支持1条/分钟（）
      2. 5条/小时
      3. 10条/天
      4. 一个手机号码只能收到40条/天
   2. 阿里（同一个签名）
      1. ​
   3. 我方规则
      1. 一个 手机设备只能发出50条/天
      2. 一个 ip 只能发出50条/天

7. 【推荐】发贴、评论、发送即时消息等用户生成内容的场景必须实现防刷、文本内容违禁词过
   滤等风控策略。 



## 附录

### 保留关键字

code



###缩写规范



3. 【强制】用户输入的 SQL 参数严格使用参数绑定或者 METADATA 字段值限定，防止 SQL 注入，
  禁止字符串拼接 SQL 访问数据库。 



注意 ReDoS  攻击